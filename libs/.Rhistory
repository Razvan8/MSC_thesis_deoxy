beta_init_lasso_minus<- -beta_init_lasso
beta_init_lasso_plus[beta_init_lasso_plus<0]<-0
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-StrongHierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init, y=y_all, lambda=lmd, t=t, tol=1e-6,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init, y=y_all, lambda=lmd, t=t, tol=1e-6,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-8 )
fitted$Theta_hat
sum(abs( fitted$Theta_hat -t(fitted$Theta_hat) ))
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-StrongHierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-8 )
sum(abs( fitted$Theta_hat -t(fitted$Theta_hat) ))
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-StrongHierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-8 )
sum(abs( fitted$Theta_hat -t(fitted$Theta_hat) ))
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-StrongHierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-8 )
sum(abs( fitted$Theta_hat -t(fitted$Theta_hat) ))
fitted$Theta_hat
test_hierarchy_layer12(fitted$Beta_hat_plus-fitted$Beta_hat_minus, fitted$Theta_hat, strong = TRUE)
all_beta_functions(beta_true, fitted$Beta_hat_plus-fitted$Beta_hat_minus)
all_beta_functions(theta_true, fitted$vec_theta_hat)
###HIERNET LIBRARY##############################################
#print("-----Hiernet library-----")
fit=hierNet(X_only_main, y_all, lam=20, diagonal = FALSE, stand.main=FALSE,tol=1e-10, strong = TRUE)
sum(abs(fti$th -t(fit$th)))
sum(abs(fit$th -t(fit$th)))
test_hierarchy_layer12(fit$bp-fit$bn, fit$th, strong=TRUE)
fit=hierNet(X_only_main, y_all, lam=20, diagonal = FALSE, stand.main=FALSE, strong = TRUE)
sum(abs(fit$th -t(fit$th)))
test_hierarchy_layer12(fit$bp-fit$bn, fit$th, strong=TRUE)
fit$aa
lmd<-45
t<-1e-4
beta_init_lasso_plus<- beta_init_lasso
beta_init_lasso_plus[beta_init_lasso_plus<0]<-0
beta_init_lasso_minus<- -beta_init_lasso
beta_init_lasso_plus[beta_init_lasso_plus<0]<-0
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
m
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-8 )
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
lmd<-45
t<-1e-3
beta_init_lasso_plus<- beta_init_lasso
beta_init_lasso_plus[beta_init_lasso_plus<0]<-0
beta_init_lasso_minus<- -beta_init_lasso
beta_init_lasso_plus[beta_init_lasso_plus<0]<-0
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
all_beta_functions(theta_true, fitted$vec_theta_hat)
lmd<-30
t<-5e-2
beta_init_lasso_plus<- beta_init_lasso
beta_init_lasso_plus[beta_init_lasso_plus<0]<-0
beta_init_lasso_minus<- -beta_init_lasso
beta_init_lasso_plus[beta_init_lasso_plus<0]<-0
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
lmd<-30
t<-5e-3
beta_init_lasso_plus<- beta_init_lasso
beta_init_lasso_plus[beta_init_lasso_plus<0]<-0
beta_init_lasso_minus<- -beta_init_lasso
beta_init_lasso_plus[beta_init_lasso_plus<0]<-0
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
lmd<-30
t<-1e-3
beta_init_lasso_plus<- beta_init_lasso
beta_init_lasso_plus[beta_init_lasso_plus<0]<-0
beta_init_lasso_minus<- -beta_init_lasso
beta_init_lasso_plus[beta_init_lasso_plus<0]<-0
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
all_beta_functions(beta_true, fitted$Beta_hat_plus-fitted$Beta_hat_minus)
all_beta_functions(theta_true, fitted$vec_theta_hat)
fitted_strong<- myWeakHierNet$fit_strong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=500, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fit_strong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=500, eps=1e-8,l1=l1,l2=l2,l3=l3)
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fit_strong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=500, eps=1e-8,l1=l1,l2=l2,l3=l3)
myWeakHierNet$fit_strong
myWeakHierNet$fit_strong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=500, eps=1e-8,l1=l1,l2=l2,l3=l3)
traceback()
myWeakHierNet$fit_strong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=500, eps=1e-8,l1=l1,l2=l2,l3=l3)
traceback()
myWeakHierNet$fit
myWeakHierNet$predict
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=500, eps=1e-8,l1=l1,l2=l2,l3=l3)
myWeakHierNet
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=500, eps=1e-8,l1=l1,l2=l2,l3=l3)
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitsrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=500, eps=1e-8,l1=l1,l2=l2,l3=l3)
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=500, eps=1e-8,l1=l1,l2=l2,l3=l3)
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=500, eps=1e-8,l1=l1,l2=l2,l3=l3)
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=500, eps=1e-8,l1=l1,l2=l2,l3=l3)
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=500, eps=1e-8,l1=l1,l2=l2,l3=l3)
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
Q
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=500, eps=1e-8,l1=l1,l2=l2,l3=l3)
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=500, eps=1e-8,l1=l1,l2=l2,l3=l3)
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=500, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=500, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-4)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-5,
max_iter=500, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-4)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-5,
max_iter=50, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-4)
sum(abs(fitted_strong$Theta_hat -t(fitted_strong$Theta_hat)))
fitted_strong$Theta_hat
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-5,
max_iter=50, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-4)
sum(abs(fitted_strong$Theta_hat -t(fitted_strong$Theta_hat)))
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-5,
max_iter=50, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e1)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-5,
max_iter=50, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-7)
sum(abs(fitted_strong$Theta_hat -t(fitted_strong$Theta_hat)))
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=50, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-7)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=100, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-7)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=100, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-9)
sum(abs(fitted_strong$Theta_hat -t(fitted_strong$Theta_hat)))
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=100, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-10)
sum(abs(fitted_strong$Theta_hat -t(fitted_strong$Theta_hat)))
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat*0, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=100, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-10)
sum(abs(fitted_strong$Theta_hat -t(fitted_strong$Theta_hat)))
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=100, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-10)
sum(abs(fitted$Theta_hat -t(fitted$Theta_hat)))
sum(abs(fitted_strong$Theta_hat -t(fitted_strong$Theta_hat)))
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=100, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-5)
sum(abs(fitted_strong$Theta_hat -t(fitted_strong$Theta_hat)))
sum(abs(fitted$Theta_hat -t(fitted$Theta_hat)))
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=100, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-5)
sum(abs(fitted_strong$Theta_hat -t(fitted_strong$Theta_hat)))
sum(abs(fitted$Theta_hat -t(fitted$Theta_hat)))
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=100, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-5)
sum(abs(fitted_strong$Theta_hat -t(fitted_strong$Theta_hat)))
sum(abs(fitted$Theta_hat -t(fitted$Theta_hat)))
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=100, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e1)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=100, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-2)
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-10, iter_strong=100)
sum(abs(fitted_strong$Theta_hat -t(fitted_strong$Theta_hat)))
sum(abs(fitted$Theta_hat -t(fitted$Theta_hat)))
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-5, iter_strong=100)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-1, iter_strong=100)
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-1, iter_strong=100)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-3, iter_strong=100)
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-3, iter_strong=100)
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-3, iter_strong=100)
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-3, iter_strong=100)
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-3, iter_strong=100)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-6, iter_strong=100)
sum(abs(fitted_strong$Theta_hat -t(fitted_strong$Theta_hat)))
sum(abs(fitted$Theta_hat -t(fitted$Theta_hat)))
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-3, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-4, iter_strong=100)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-4, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-4, iter_strong=100)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-4, tol=1e-6,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-5, iter_strong=100)
sum(abs(fitted_strong$Theta_hat -t(fitted_strong$Theta_hat)))
sum(abs(fitted$Theta_hat -t(fitted$Theta_hat)))
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-4, tol=1e-6,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-5, iter_strong=1000)
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-4, tol=1e-6,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-5, iter_strong=1000)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-4, tol=1e-6,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-5, iter_strong=100)
sum(abs(fitted_strong$Theta_hat -t(fitted_strong$Theta_hat)))
sum(abs(fitted$Theta_hat -t(fitted$Theta_hat)))
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
source(file.path(libs_path,'StrongHierNet_Class_corrected_unscaled.R'))
myWeakHierNet<-HierNetUnscaled (X=X_only_main, Beta_plus_init=beta_init_lasso_plus, Beta_minus_init=beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8, center = FALSE, standard_form=TRUE)  #Increase max iter if needed or decrease tol
# Fit the model
fitted=myWeakHierNet$fit(X=X_only_main,Beta_plus_init=beta_init_lasso_plus, Beta_minus_init = beta_init_lasso_minus,
Theta_init=theta_init*0, y=y_all, lambda=lmd, t=t, tol=1e-7,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3)
fitted_strong<- myWeakHierNet$fitstrong(X=X_only_main,Beta_plus_init=fitted$Beta_hat_plus, Beta_minus_init = fitted$Beta_hat_minus,
Theta_init=fitted$Theta_hat, y=y_all, lambda=lmd, t=1e-4, tol=1e-6,
max_iter=10000, eps=1e-8,l1=l1,l2=l2,l3=l3, rho=1e-5, iter_strong=100)
sum(abs(fitted_strong$Theta_hat -t(fitted_strong$Theta_hat)))
sum(abs(fitted$Theta_hat -t(fitted$Theta_hat)))
